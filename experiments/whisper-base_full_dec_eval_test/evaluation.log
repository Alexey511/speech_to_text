2025-11-11 08:05:10,740 - src.utils - INFO - Logging setup complete. Level: INFO
2025-11-11 08:05:10,740 - src.utils - INFO - Log file: experiments\whisper-base_full_dec_eval_test\evaluation.log
2025-11-11 08:05:10,741 - src.utils - INFO - Evaluation directory: experiments\whisper-base_full_dec_eval_test
2025-11-11 08:05:10,741 - src.utils - INFO - Log file: experiments\whisper-base_full_dec_eval_test\evaluation.log
2025-11-11 08:05:10,741 - src.utils - INFO - Model path: experiments/whisper-base_train_full_decoder/checkpoints/epoch_4
2025-11-11 08:05:10,766 - src.utils - INFO - Configuration saved to: experiments\whisper-base_full_dec_eval_test\config.yaml
2025-11-11 08:05:10,844 - __main__ - INFO - Initializing data manager...
2025-11-11 08:05:10,845 - __main__ - INFO - Loading model and processor...
2025-11-11 08:05:10,845 - __main__ - INFO - Initializing model manager...
2025-11-11 08:05:10,845 - src.models - INFO - CUDA optimizations enabled (cudnn.benchmark=True)
2025-11-11 08:05:10,845 - src.models - INFO - ModelManager initialized
2025-11-11 08:05:10,846 - __main__ - INFO - Using device: cuda
2025-11-11 08:05:10,846 - __main__ - INFO - Loading checkpoint from: experiments/whisper-base_train_full_decoder/checkpoints/epoch_4
2025-11-11 08:05:10,846 - src.models - INFO - Creating processor from checkpoint config: openai/whisper-base
2025-11-11 08:05:10,847 - src.models - INFO - Creating WhisperProcessor with language='ru', task='transcribe'
2025-11-11 08:05:13,026 - src.models - INFO - Loading Whisper model: openai/whisper-base
2025-11-11 08:05:15,133 - src.models - INFO - Feature encoder frozen (conv1, conv2, embed_positions)
2025-11-11 08:05:15,134 - src.models - INFO - Encoder frozen
2025-11-11 08:05:15,136 - src.models - INFO - Model loaded. Total parameters: 72,593,920, Trainable: 52,003,328
2025-11-11 08:05:15,136 - src.models - INFO - Model created: whisper - openai/whisper-base
2025-11-11 08:05:15,514 - src.models - INFO - Loaded weights from experiments\whisper-base_train_full_decoder\checkpoints\epoch_4\model_weights.pt
2025-11-11 08:05:15,577 - src.models - INFO - Model moved to device: cuda
2025-11-11 08:05:15,578 - src.models - INFO - Model Info: {'model_type': 'whisper', 'model_name': 'openai/whisper-base', 'total_parameters': 72593920, 'trainable_parameters': 52003328, 'trainable_ratio': 0.7163592763691504}
2025-11-11 08:05:15,579 - src.data - INFO - Set pad_token_id: 50257
2025-11-11 08:05:15,579 - src.data - INFO - WhisperProcessor verified: language='ru', task='transcribe'
2025-11-11 08:05:15,579 - __main__ - INFO - Loaded checkpoint: model=openai/whisper-base
2025-11-11 08:05:15,579 - __main__ - INFO - Using GPU: NVIDIA GeForce RTX 4070 Ti
2025-11-11 08:05:15,579 - __main__ - INFO - GPU Memory: 11.99 GB
2025-11-11 08:05:15,579 - __main__ - INFO - Evaluating on test dataset...
2025-11-11 08:05:15,579 - __main__ - INFO - Loading test dataset...
2025-11-11 08:05:15,579 - src.data - INFO - Loading test split from TSV file C:\Users\User\Documents\Progs\Projects\seepch_to_text\data\cv-corpus-22.0-2025-06-20\ru\test.tsv...
2025-11-11 08:05:15,610 - src.data - INFO - Loaded 10,244 samples from test split
2025-11-11 08:05:15,610 - src.data - INFO - Loading clip durations from clip_durations.tsv...
2025-11-11 08:05:15,733 - src.data - INFO - Merged durations for 10244 samples
2025-11-11 08:05:15,735 - src.data - INFO - Pre-filtered 0 samples by metadata duration (min: 0.2s, max: 30.0s). Final filtering after trim_silence happens in AudioPreprocessor.
2025-11-11 08:05:15,736 - src.data - INFO - After filtering: 10,244 samples remaining
2025-11-11 08:05:15,736 - src.data - INFO - Cached test split with 10244 samples
2025-11-11 08:05:15,745 - __main__ - INFO - Evaluating on 10244 samples from test split
2025-11-11 08:05:15,745 - src.data - INFO - Initialized AudioCollator with device: cpu, model_type: whisper, labels padding: -100, transpose_features: False
2025-11-11 08:05:15,745 - __main__ - INFO - Batch size: 128
2025-11-11 08:05:15,745 - __main__ - INFO - Total batches: 81
2025-11-11 08:05:15,746 - __main__ - INFO - Device: cuda:0
2025-11-11 08:05:15,746 - __main__ - INFO - Starting evaluation loop...
2025-11-11 08:12:10,951 - __main__ - INFO - Evaluation loop completed. Processing results...
2025-11-11 08:12:10,951 - __main__ - INFO - Computing metrics...
2025-11-11 08:12:21,194 - __main__ - INFO - WER: 0.2456, CER: 0.0804
2025-11-11 08:12:21,230 - __main__ - INFO - TensorBoard logs saved to: experiments\whisper-base_full_dec_eval_test
2025-11-11 08:12:21,230 - __main__ - INFO - Metrics saved to: experiments\whisper-base_full_dec_eval_test\test_results.json
2025-11-11 08:12:21,231 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,231 - __main__ - INFO - Evaluation Results on test split:
2025-11-11 08:12:21,231 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,231 - __main__ - INFO - Word Error Rate (WER): 0.2456 (24.56%)
2025-11-11 08:12:21,231 - __main__ - INFO - Character Error Rate (CER): 0.0804 (8.04%)
2025-11-11 08:12:21,231 - __main__ - INFO - BLEU Score: 0.6252
2025-11-11 08:12:21,231 - __main__ - INFO - Substitutions: 16,609
2025-11-11 08:12:21,232 - __main__ - INFO - Deletions: 2,053
2025-11-11 08:12:21,232 - __main__ - INFO - Insertions: 2,507
2025-11-11 08:12:21,232 - __main__ - INFO - Correct Words: 67,546
2025-11-11 08:12:21,232 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,268 - __main__ - INFO - Predictions saved to: experiments\whisper-base_full_dec_eval_test\test_predictions.csv
2025-11-11 08:12:21,269 - __main__ - INFO - Sample predictions:
2025-11-11 08:12:21,269 - __main__ - INFO -   Reference:  К сожалению, эти предложения не нашли отражения в тексте.
2025-11-11 08:12:21,269 - __main__ - INFO -   Prediction: К сожалению, эти предложения не наследны отражению в текст.
2025-11-11 08:12:21,269 - __main__ - INFO -   ---
2025-11-11 08:12:21,270 - __main__ - INFO -   Reference:  Эти меры важны для того, чтобы базировать последующие разоруженческие усилия на прочном фундаменте.
2025-11-11 08:12:21,270 - __main__ - INFO -   Prediction: Эти меры должны для того, чтобы позиции в последующие разоруженческие усилия на прочном фундаменте.
2025-11-11 08:12:21,270 - __main__ - INFO -   ---
2025-11-11 08:12:21,270 - __main__ - INFO -   Reference:  Толпа озвереет, будет тереться, ощетинит ножки стоглавая вошь.
2025-11-11 08:12:21,270 - __main__ - INFO -   Prediction: Толпа звереет, будет терреса щитинил ножки с торговой овожь.
2025-11-11 08:12:21,270 - __main__ - INFO -   ---
2025-11-11 08:12:21,270 - __main__ - INFO - Performing detailed error analysis...
2025-11-11 08:12:21,808 - __main__ - INFO - Detailed analysis saved to: experiments\whisper-base_full_dec_eval_test\test_detailed_analysis.json
2025-11-11 08:12:21,808 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,808 - __main__ - INFO - Detailed Error Analysis:
2025-11-11 08:12:21,808 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,808 - __main__ - INFO - Total Samples: 10,244
2025-11-11 08:12:21,809 - __main__ - INFO - Perfect Matches: 3,184 (31.08%)
2025-11-11 08:12:21,809 - __main__ - INFO - Empty Predictions: 0 (0.00%)
2025-11-11 08:12:21,809 - __main__ - INFO - Overall WER: 0.2456
2025-11-11 08:12:21,809 - __main__ - INFO - 
WER by Text Length (words in reference):
2025-11-11 08:12:21,809 - __main__ - INFO -   1-4: WER=0.3433, Count=947
2025-11-11 08:12:21,809 - __main__ - INFO -   4-7: WER=0.2899, Count=2,490
2025-11-11 08:12:21,809 - __main__ - INFO -   7-10: WER=0.2533, Count=2,606
2025-11-11 08:12:21,809 - __main__ - INFO -   10-13: WER=0.2343, Count=2,589
2025-11-11 08:12:21,810 - __main__ - INFO -   13-16: WER=0.2165, Count=1,612
2025-11-11 08:12:21,810 - __main__ - INFO -   16-inf: WER=0.0000, Count=0
2025-11-11 08:12:21,810 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,810 - __main__ - INFO - 
============================================================
2025-11-11 08:12:21,810 - __main__ - INFO - View evaluation metrics in TensorBoard:
2025-11-11 08:12:21,810 - __main__ - INFO -   tensorboard --logdir experiments\whisper-base_full_dec_eval_test
2025-11-11 08:12:21,810 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,811 - __main__ - INFO - ============================================================
2025-11-11 08:12:21,811 - __main__ - INFO - Evaluation completed successfully!
2025-11-11 08:12:21,811 - __main__ - INFO - Results saved to: experiments\whisper-base_full_dec_eval_test
2025-11-11 08:12:21,811 - __main__ - INFO - ============================================================
